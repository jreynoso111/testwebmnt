<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unit Detail</title>
  <link rel="icon" href="https://i.imgur.com/kopRNDu.png" type="image/png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <script src="inventory-seed.js"></script>
  <style>
    :root { --font-main: "Inter","Segoe UI",system-ui,-apple-system,sans-serif; }
    *, *::before, *::after { box-sizing: border-box; font-family: var(--font-main); }
    body { margin:0; background:#f5f7f6; color:#0b2520; line-height:1.6; }
    a { color:inherit; text-decoration:none; }
    img { max-width:100%; display:block; }
    header { background:#fff; box-shadow:0 2px 6px rgba(0,0,0,.08); padding:12px 16px; position:sticky; top:0; z-index:10; }
    .container { max-width:1100px; margin:20px auto 60px; padding:0 18px; }
    .crumbs { font-size:12px; color:#4c5f5a; margin-bottom:10px; }
    .detail-card { background:#fff; border:1px solid #d8e5e0; border-radius:14px; box-shadow:0 6px 18px rgba(0,0,0,.05); overflow:hidden; }
    .detail-header { padding:18px 18px 6px; display:flex; flex-wrap:wrap; gap:10px; align-items:flex-start; justify-content:space-between; }
    .title { font-size:22px; font-weight:800; margin:0; color:#0b2520; }
    .vin { font-size:13px; color:#2d4a43; font-weight:600; }
    .status { padding:6px 12px; border-radius:999px; font-size:11px; font-weight:700; text-transform:uppercase; letter-spacing:.05em; }
    .status.available { background:#e7f8f1; color:#0b5e48; border:1px solid #b8e3d2; }
    .status.sold { background:#fde8e8; color:#9b1c1c; border:1px solid #f7c5c5; }
    .detail-body { display:grid; grid-template-columns:1.1fr 0.9fr; gap:18px; padding:0 18px 18px; }
    .hero-img { border-radius:12px; overflow:hidden; background:#e3ece9; }
    .specs { background:#f8fbfa; border:1px solid #dbe7e3; border-radius:12px; padding:14px; }
    .specs h3 { margin-top:0; margin-bottom:10px; font-size:15px; font-weight:800; }
    .spec-list { list-style:none; padding:0; margin:0; display:grid; grid-template-columns:1fr 1fr; gap:8px 12px; font-size:13px; }
    .cta-row { display:flex; gap:10px; flex-wrap:wrap; margin-top:14px; }
    .btn { border-radius:999px; padding:10px 16px; font-weight:700; border:1px solid #005e4a; cursor:pointer; font-size:13px; }
    .btn.primary { background:#005e4a; color:#fff; }
    .btn.ghost { background:#fff; color:#005e4a; }
    .panel { background:#ffffff; border:1px solid #d8e5e0; border-radius:12px; padding:14px; box-shadow:0 3px 12px rgba(0,0,0,.04); }
    .panel h3 { margin:0 0 8px; font-size:15px; font-weight:800; }
    .muted { color:#4f615c; font-size:13px; }
    footer { margin-top:24px; font-size:12px; color:#556560; text-align:center; }
    @media (max-width: 768px) { .detail-body { grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <header>
    <div style="display:flex; align-items:center; gap:12px;">
      <a href="Inventory.html"><img src="Media/Logo White - Copy.png" alt="Logo" style="width:110px; height:auto;" /></a>
      <div style="font-size:13px; color:#2b3d38; font-weight:700;">Unit details</div>
    </div>
  </header>

  <main class="container">
    <div class="crumbs"><a href="Inventory.html">Inventory</a> &gt; <a href="Units for Sale.html">All units</a> &gt; <span id="crumbVin">Details</span></div>
    <div class="detail-card" id="detailCard" style="display:none;">
      <div class="detail-header">
        <div>
          <h1 class="title" id="detailTitle"></h1>
          <div class="vin" id="detailVin"></div>
        </div>
        <div class="status" id="detailStatus"></div>
      </div>
      <div class="detail-body">
        <div class="hero-img" id="imageWrap">
          <img id="detailImage" alt="Unit image" />
        </div>
        <div class="specs">
          <h3>Key specifications</h3>
          <ul class="spec-list">
            <li><strong>Type:</strong> <span id="specType"></span></li>
            <li><strong>Brand:</strong> <span id="specBrand"></span></li>
            <li><strong>Price:</strong> <span id="specPrice"></span></li>
            <li><strong>Mileage:</strong> <span id="specMileage"></span></li>
            <li><strong>Color:</strong> <span id="specColor"></span></li>
            <li><strong>State:</strong> <span id="specState"></span></li>
          </ul>
          <div class="cta-row">
            <button class="btn primary" id="ctaCall" type="button">Call 201-201-3551</button>
            <button class="btn ghost" id="ctaEmail" type="button">Email about this unit</button>
          </div>
        </div>
      </div>
    </div>

    <div class="panel" id="missingPanel" style="display:none;">
      <h3>Listing not found</h3>
      <p class="muted">We couldn’t find a listing for that VIN. Return to the inventory to choose another unit.</p>
      <div class="cta-row">
        <a class="btn primary" href="Units for Sale.html">Back to all units</a>
        <a class="btn ghost" href="Inventory.html">Inventory overview</a>
      </div>
    </div>
    <footer>&copy; 2025 M&T Equipment Funding LLC — Commercial Truck &amp; Trailer Financing</footer>
  </main>

  <script>
    function loadUnits() {
      try {
        const saved = localStorage.getItem('inventoryData');
        if (saved) {
          const parsed = JSON.parse(saved);
          if (Array.isArray(parsed) && parsed.length) return parsed;
        }
      } catch (e) {
        console.warn('Unable to read saved inventory, using defaults');
      }
      return Array.isArray(window.INVENTORY_SEED) ? window.INVENTORY_SEED : [];
    }

    function lookupUnit() {
      const params = new URLSearchParams(window.location.search);
      let vin = params.get('vin');
      if (!vin) {
        const path = window.location.pathname.split('/').pop();
        vin = path?.replace('.html','');
      }
      if (!vin) return null;
      const units = loadUnits();
      return units.find(u => (u.vin || '').toLowerCase() === vin.toLowerCase()) || null;
    }

    function formatNumber(n) {
      return Number(n || 0).toLocaleString('en-US');
    }

    function render(unit) {
      const card = document.getElementById('detailCard');
      const missing = document.getElementById('missingPanel');
      const crumbVin = document.getElementById('crumbVin');
      if (!unit) {
        card.style.display = 'none';
        missing.style.display = 'block';
        crumbVin.textContent = 'Not found';
        return;
      }
      card.style.display = 'block';
      missing.style.display = 'none';
      crumbVin.textContent = unit.vin;

      document.getElementById('detailTitle').textContent = unit.title || 'Unit';
      document.getElementById('detailVin').textContent = `VIN: ${unit.vin || 'N/A'}`;
      const statusEl = document.getElementById('detailStatus');
      statusEl.textContent = unit.status || 'Available';
      statusEl.className = `status ${(unit.status || '').toLowerCase()==='sold' ? 'sold' : 'available'}`;
      document.getElementById('detailImage').src = unit.image || '';
      document.getElementById('detailImage').alt = unit.title || 'Unit image';
      document.getElementById('specType').textContent = unit.type || 'N/A';
      document.getElementById('specBrand').textContent = unit.brand || 'N/A';
      document.getElementById('specPrice').textContent = `USD$ ${formatNumber(unit.price)}`;
      document.getElementById('specMileage').textContent = `${formatNumber(unit.mileage)} mi`;
      document.getElementById('specColor').textContent = unit.color || 'Unknown';
      document.getElementById('specState').textContent = unit.state || 'Unknown';

      document.getElementById('ctaCall').onclick = () => window.location.href = 'tel:2012013551';
      document.getElementById('ctaEmail').onclick = () => {
        const subject = `Interest in ${unit.title || 'unit'} (${unit.vin || ''})`;
        const body = `Hello,\n\nI am interested in this listing and would like more details.\n\n${unit.title || ''}\nVIN: ${unit.vin || ''}\n\nThank you.`;
        window.location.href = `mailto:RCortez@mntfunding.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
      };
    }

    document.addEventListener('DOMContentLoaded', () => {
      const unit = lookupUnit();
      render(unit);
    });
  </script>
</body>
</html>
